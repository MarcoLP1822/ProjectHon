{"ast":null,"code":"import axios from 'axios';\nconst api = axios.create({\n  baseURL: 'http://localhost:5002/api'\n});\nexport const bookService = {\n  uploadBook: async file => {\n    const formData = new FormData();\n    formData.append('book', file);\n    const response = await api.post('/books/upload', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    return response.data;\n  },\n  getBooks: async () => {\n    const response = await api.get('/books');\n    return response.data;\n  },\n  deleteBook: async id => {\n    const response = await api.delete(`/books/${id}`);\n    return response.data;\n  },\n  updateBook: async (id, data) => {\n    const response = await api.put(`/books/${id}`, data);\n    return response.data;\n  },\n  generateCategories: async bookId => {\n    const response = await api.post(`/ai/categories/${bookId}`);\n    return response.data;\n  },\n  generateKeywords: async bookId => {\n    const response = await api.post(`/ai/keywords/${bookId}`);\n    return response.data;\n  },\n  regenerateCategory: async (bookId, type, currentCategories) => {\n    const response = await api.post(`/ai/categories/${bookId}/${type}`, {\n      currentCategories\n    });\n    return response.data;\n  },\n  regenerateKeyword: async (bookId, index, currentKeywords) => {\n    try {\n      const formattedKeywords = {\n        keywords: Array.isArray(currentKeywords.keywords) ? currentKeywords.keywords : []\n      };\n      const response = await api.post(`/ai/keywords/${bookId}/regenerate`, {\n        index: parseInt(index, 10),\n        currentKeywords: formattedKeywords\n      });\n      console.log('API Response:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('API Error - regenerateKeyword:', error);\n      throw error;\n    }\n  },\n  getStorageStatus: async () => {\n    const response = await api.get('/books/storage-status');\n    return response.data;\n  },\n  cleanupStorage: async (force = false) => {\n    const response = await api.post(`/books/cleanup?force=${force}`);\n    return response.data;\n  },\n  generateScenes: async bookId => {\n    const response = await api.post(`/ai/scenes/${bookId}`);\n    return response.data;\n  },\n  generateCoverImages: async (bookId, scenes) => {\n    console.log('API: Sending scenes data:', JSON.stringify(scenes, null, 2));\n\n    // Validazione base\n    if (!Array.isArray(scenes)) {\n      throw new Error('Scenes must be an array');\n    }\n    if (scenes.length === 0) {\n      throw new Error('Scenes array is empty');\n    }\n\n    // Verifica che ogni scena abbia i campi necessari\n    scenes.forEach((scene, index) => {\n      if (!scene.title || !scene.description) {\n        throw new Error(`Scene at index ${index} is missing required fields`);\n      }\n    });\n    const response = await api.post(`/ai/covers/${bookId}`, {\n      scenes\n    });\n    return response.data;\n  },\n  resetBookData: async bookId => {\n    const response = await api.post(`/books/${bookId}/reset`);\n    return response.data;\n  },\n  generateBackCover: async bookId => {\n    const response = await api.post(`/ai/backcover/${bookId}`);\n    return response.data;\n  },\n  generatePreface: async bookId => {\n    const response = await api.post(`/ai/preface/${bookId}`);\n    return response.data;\n  },\n  generateStoreDescription: async bookId => {\n    console.log('API Service: Generating store description for book:', bookId);\n    try {\n      const response = await api.post(`/ai/store-description/${bookId}`);\n      console.log('API Service: Response:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('API Service: Error:', error);\n      throw error;\n    }\n  }\n};","map":{"version":3,"names":["axios","api","create","baseURL","bookService","uploadBook","file","formData","FormData","append","response","post","headers","data","getBooks","get","deleteBook","id","delete","updateBook","put","generateCategories","bookId","generateKeywords","regenerateCategory","type","currentCategories","regenerateKeyword","index","currentKeywords","formattedKeywords","keywords","Array","isArray","parseInt","console","log","error","getStorageStatus","cleanupStorage","force","generateScenes","generateCoverImages","scenes","JSON","stringify","Error","length","forEach","scene","title","description","resetBookData","generateBackCover","generatePreface","generateStoreDescription"],"sources":["/Users/marcolp/AI/CURSOR projects/Lose/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\n\nconst api = axios.create({\n  baseURL: 'http://localhost:5002/api'\n});\n\nexport const bookService = {\n  uploadBook: async (file) => {\n    const formData = new FormData();\n    formData.append('book', file);\n    const response = await api.post('/books/upload', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    return response.data;\n  },\n\n  getBooks: async () => {\n    const response = await api.get('/books');\n    return response.data;\n  },\n\n  deleteBook: async (id) => {\n    const response = await api.delete(`/books/${id}`);\n    return response.data;\n  },\n\n  updateBook: async (id, data) => {\n    const response = await api.put(`/books/${id}`, data);\n    return response.data;\n  },\n\n  generateCategories: async (bookId) => {\n    const response = await api.post(`/ai/categories/${bookId}`);\n    return response.data;\n  },\n\n  generateKeywords: async (bookId) => {\n    const response = await api.post(`/ai/keywords/${bookId}`);\n    return response.data;\n  },\n\n  regenerateCategory: async (bookId, type, currentCategories) => {\n    const response = await api.post(`/ai/categories/${bookId}/${type}`, { currentCategories });\n    return response.data;\n  },\n\n  regenerateKeyword: async (bookId, index, currentKeywords) => {\n    try {\n      const formattedKeywords = {\n        keywords: Array.isArray(currentKeywords.keywords) \n          ? currentKeywords.keywords \n          : []\n      };\n\n      const response = await api.post(`/ai/keywords/${bookId}/regenerate`, {\n        index: parseInt(index, 10),\n        currentKeywords: formattedKeywords\n      });\n      \n      console.log('API Response:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('API Error - regenerateKeyword:', error);\n      throw error;\n    }\n  },\n\n  getStorageStatus: async () => {\n    const response = await api.get('/books/storage-status');\n    return response.data;\n  },\n\n  cleanupStorage: async (force = false) => {\n    const response = await api.post(`/books/cleanup?force=${force}`);\n    return response.data;\n  },\n\n  generateScenes: async (bookId) => {\n    const response = await api.post(`/ai/scenes/${bookId}`);\n    return response.data;\n  },\n\n  generateCoverImages: async (bookId, scenes) => {\n    console.log('API: Sending scenes data:', JSON.stringify(scenes, null, 2));\n    \n    // Validazione base\n    if (!Array.isArray(scenes)) {\n      throw new Error('Scenes must be an array');\n    }\n    \n    if (scenes.length === 0) {\n      throw new Error('Scenes array is empty');\n    }\n    \n    // Verifica che ogni scena abbia i campi necessari\n    scenes.forEach((scene, index) => {\n      if (!scene.title || !scene.description) {\n        throw new Error(`Scene at index ${index} is missing required fields`);\n      }\n    });\n    \n    const response = await api.post(`/ai/covers/${bookId}`, { scenes });\n    return response.data;\n  },\n\n  resetBookData: async (bookId) => {\n    const response = await api.post(`/books/${bookId}/reset`);\n    return response.data;\n  },\n\n  generateBackCover: async (bookId) => {\n    const response = await api.post(`/ai/backcover/${bookId}`);\n    return response.data;\n  },\n\n  generatePreface: async (bookId) => {\n    const response = await api.post(`/ai/preface/${bookId}`);\n    return response.data;\n  },\n\n  generateStoreDescription: async (bookId) => {\n    console.log('API Service: Generating store description for book:', bookId);\n    try {\n      const response = await api.post(`/ai/store-description/${bookId}`);\n      console.log('API Service: Response:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('API Service: Error:', error);\n      throw error;\n    }\n  },\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}